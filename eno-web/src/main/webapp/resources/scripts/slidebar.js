function Event(e){var t=isIE?window.event:e;return isIE&&(t.pageX=t.clientX+document.documentElement.scrollLeft,t.pageY=t.clientY+document.documentElement.scrollTop,t.preventDefault=function(){this.returnValue=!1},t.detail=t.wheelDelta/-40,t.stopPropagation=function(){this.cancelBubble=!0}),t}function addEventHandler(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}function removeEventHandler(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null}var isIE=document.all?!0:!1,$$=function(e){return"string"==typeof e?document.getElementById(e):e},Class={create:function(){return function(){this.initialize.apply(this,arguments)}}},Extend=function(e,t){for(var n in t)e[n]=t[n]},Bind=function(e,t){var n=Array.prototype.slice.call(arguments).slice(2);return function(){return t.apply(e,n)}},BindAsEventListener=function(e,t){return function(n){return t.call(e,Event(n))}},Each=function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)},CurrentStyle=function(e){return e.currentStyle||document.defaultView.getComputedStyle(e,null)},Slider=Class.create();Slider.prototype={initialize:function(e,t,n){this.Bar=$$(t),this.Container=$$(e),this._timer=null,this._ondrag=!1,this._IsMin=this._IsMax=this._IsMid=!1,this._drag=new Drag(this.Bar,{Limit:!0,mxContainer:this.Container,onStart:Bind(this,this.DragStart),onStop:Bind(this,this.DragStop),onMove:Bind(this,this.Move)}),this.SetOptions(n),this.WheelSpeed=Math.max(0,this.options.WheelSpeed),this.KeySpeed=Math.max(0,this.options.KeySpeed),this.MinValue=this.options.MinValue,this.MaxValue=this.options.MaxValue,this.RunTime=Math.max(1,this.options.RunTime),this.RunStep=Math.max(1,this.options.RunStep),this.Ease=!!this.options.Ease,this.EaseStep=Math.max(1,this.options.EaseStep),this.onMin=this.options.onMin,this.onMax=this.options.onMax,this.onMid=this.options.onMid,this.onDragStart=this.options.onDragStart,this.onDragStop=this.options.onDragStop,this.onMove=this.options.onMove,this._horizontal=!!this.options.Horizontal,this._drag[this._horizontal?"LockY":"LockX"]=!0,addEventHandler(this.Container,"click",BindAsEventListener(this,function(e){this._ondrag||this.ClickCtrl(e)})),addEventHandler(this.Bar,"click",BindAsEventListener(this,function(e){e.stopPropagation()})),this.WheelBind(this.Container),this.KeyBind(this.Container);var r=isIE?(this.KeyBind(this.Bar),this.Bar):this.Container;addEventHandler(this.Bar,"mousedown",function(){r.focus()})},SetOptions:function(e){this.options={MinValue:0,MaxValue:100,WheelSpeed:5,KeySpeed:50,Horizontal:!0,RunTime:20,RunStep:2,Ease:!1,EaseStep:5,onMin:function(){},onMax:function(){},onMid:function(){},onDragStart:function(){},onDragStop:function(){},onMove:function(){}},Extend(this.options,e||{})},DragStart:function(){this.Stop(),this.onDragStart(),this._ondrag=!0},DragStop:function(){this.onDragStop(),setTimeout(Bind(this,function(){this._ondrag=!1}),10)},Move:function(){this.onMove();var e=this.GetPercent();e>0?this._IsMin=!1:this._IsMin||(this.onMin(),this._IsMin=!0),e<1?this._IsMax=!1:this._IsMax||(this.onMax(),this._IsMax=!0),e>0&&e<1?this._IsMid||(this.onMid(),this._IsMid=!0):this._IsMid=!1},ClickCtrl:function(e){var t=this.Container,n=t.offsetLeft,r=t.offsetTop;while(t.offsetParent)t=t.offsetParent,n+=t.offsetLeft,r+=t.offsetTop;this.EasePos(e.pageX-n-this.Bar.offsetWidth/2,e.pageY-r-this.Bar.offsetHeight/2)},WheelCtrl:function(e){var t=this.WheelSpeed*e.detail;this.SetPos(this.Bar.offsetLeft+t,this.Bar.offsetTop+t),e.preventDefault()},WheelBind:function(e){addEventHandler(e,isIE?"mousewheel":"DOMMouseScroll",BindAsEventListener(this,this.WheelCtrl))},KeyCtrl:function(e){if(this.KeySpeed){var t=this.Bar.offsetLeft,n=(this.Container.clientWidth-this.Bar.offsetWidth)/this.KeySpeed,r=this.Bar.offsetTop,i=(this.Container.clientHeight-this.Bar.offsetHeight)/this.KeySpeed;switch(e.keyCode){case 37:t-=n;break;case 38:r-=i;break;case 39:t+=n;break;case 40:r+=i;break;default:return}this.SetPos(t,r),e.preventDefault()}},KeyBind:function(e){addEventHandler(e,"keydown",BindAsEventListener(this,this.KeyCtrl)),e.tabIndex=-1,isIE||(e.style.outline="none")},GetValue:function(){return this.MinValue+this.GetPercent()*(this.MaxValue-this.MinValue)},SetValue:function(e){this.SetPercent((e-this.MinValue)/(this.MaxValue-this.MinValue))},GetPercent:function(){return this._horizontal?this.Bar.offsetLeft/(this.Container.clientWidth-this.Bar.offsetWidth):this.Bar.offsetTop/(this.Container.clientHeight-this.Bar.offsetHeight)},SetPercent:function(e){this.EasePos((this.Container.clientWidth-this.Bar.offsetWidth)*e,(this.Container.clientHeight-this.Bar.offsetHeight)*e)},Run:function(e){this.Stop(),e=!!e;var t=this.GetPercent()+(e?1:-1)*this.RunStep/100;this.SetPos((this.Container.clientWidth-this.Bar.offsetWidth)*t,(this.Container.clientHeight-this.Bar.offsetHeight)*t);if(e?!this._IsMax:!this._IsMin)this._timer=setTimeout(Bind(this,this.Run,e),this.RunTime)},Stop:function(){clearTimeout(this._timer)},EasePos:function(e,t){this.Stop(),e=Math.round(e),t=Math.round(t);if(!this.Ease){this.SetPos(e,t);return}var n=this.Bar.offsetLeft,r=this.GetStep(e,n),i=this.Bar.offsetTop,s=this.GetStep(t,i);if(this._horizontal?r:s)this.SetPos(n+r,i+s),this._IsMid&&(this._timer=setTimeout(Bind(this,this.EasePos,e,t),this.RunTime))},GetStep:function(e,t){var n=(e-t)/this.EaseStep;return n==0?0:Math.abs(n)<1?n>0?1:-1:n},SetPos:function(e,t){this.Stop(),this._drag.SetPos(e,t)}};var Drag=Class.create();Drag.prototype={initialize:function(drag,options){this.Drag=$$(drag),this._x=this._y=0,this._marginLeft=this._marginTop=0,this._fM=BindAsEventListener(this,this.Move),this._fS=Bind(this,this.Stop),this.SetOptions(options),this.Limit=!!this.options.Limit,this.mxLeft=parseInt(this.options.mxLeft),this.mxRight=parseInt(this.options.mxRight),this.mxTop=parseInt(this.options.mxTop),this.mxBottom=parseInt(this.options.mxBottom),this.LockX=!!this.options.LockX,this.LockY=!!this.options.LockY,this.Lock=!!this.options.Lock,this.onStart=this.options.onStart,this.onMove=this.options.onMove,this.onStop=this.options.onStop,this._Handle=$$(this.options.Handle)||this.Drag,this._mxContainer=$$(this.options.mxContainer)||null,this.Drag.style.position="absolute";if(isIE&&!!this.options.Transparent){this._Handle.style.overflow="hidden";with(this._Handle.appendChild(document.createElement("div")).style)width=height="100%",backgroundColor="#fff",filter="alpha(opacity:0)"}this.Repair(),addEventHandler(this._Handle,"mousedown",BindAsEventListener(this,this.Start))},SetOptions:function(e){this.options={Handle:"",Limit:!1,mxLeft:0,mxRight:9999,mxTop:0,mxBottom:9999,mxContainer:"",LockX:!1,LockY:!1,Lock:!1,Transparent:!1,onStart:function(){},onMove:function(){},onStop:function(){}},Extend(this.options,e||{})},Start:function(e){if(this.Lock)return;this.Repair(),this._x=e.clientX-this.Drag.offsetLeft,this._y=e.clientY-this.Drag.offsetTop,this._marginLeft=parseInt(CurrentStyle(this.Drag).marginLeft)||0,this._marginTop=parseInt(CurrentStyle(this.Drag).marginTop)||0,addEventHandler(document,"mousemove",this._fM),addEventHandler(document,"mouseup",this._fS),isIE?(addEventHandler(this._Handle,"losecapture",this._fS),this._Handle.setCapture()):(addEventHandler(window,"blur",this._fS),e.preventDefault()),this.onStart()},Repair:function(){this.Limit&&(this.mxRight=Math.max(this.mxRight,this.mxLeft+this.Drag.offsetWidth),this.mxBottom=Math.max(this.mxBottom,this.mxTop+this.Drag.offsetHeight),!this._mxContainer||CurrentStyle(this._mxContainer).position=="relative"||CurrentStyle(this._mxContainer).position=="absolute"||(this._mxContainer.style.position="relative"))},Move:function(e){if(this.Lock){this.Stop();return}window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),this.SetPos(e.clientX-this._x,e.clientY-this._y)},SetPos:function(e,t){if(this.Limit){var n=this.mxLeft,r=this.mxRight,i=this.mxTop,s=this.mxBottom;!this._mxContainer||(n=Math.max(n,0),i=Math.max(i,0),r=Math.min(r,this._mxContainer.clientWidth),s=Math.min(s,this._mxContainer.clientHeight)),e=Math.max(Math.min(e,r-this.Drag.offsetWidth),n),t=Math.max(Math.min(t,s-this.Drag.offsetHeight),i)}this.LockX||(this.Drag.style.left=e-this._marginLeft+"px"),this.LockY||(this.Drag.style.top=t-this._marginTop+"px"),this.onMove()},Stop:function(){removeEventHandler(document,"mousemove",this._fM),removeEventHandler(document,"mouseup",this._fS),isIE?(removeEventHandler(this._Handle,"losecapture",this._fS),this._Handle.releaseCapture()):removeEventHandler(window,"blur",this._fS),this.onStop()}}