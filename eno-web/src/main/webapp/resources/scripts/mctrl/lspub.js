var customConfig = {
	"B1" : [
		{"name" : "GGZM_1_0_3",		 "pos" : [{"left" : "343px","top" : "173px"}]},
		{"name" : "GGZM_1_0_4",		 "pos" : [{"left" : "306px","top" : "204px"}]},
		{"name" : "GGZM_1_0_1",		 "pos" : [{"left" : "345px","top" : "255px"}]},
		{"name" : "GGZM_1_0_2",		 "pos" : [{"left" : "322px","top" : "388px"}]},
		{"name" : "GGZM_1_0_9",		 "pos" : [{"left" : "481px","top" : "377px"}]},
		{"name" : "GGZM_1_0_6",		 "pos" : [{"left" : "425px","top" : "312px"}]},
		{"name" : "GGZM_1_0_14",		 "pos" : [{"left" : "562px","top" : "370px"}]},
		{"name" : "GGZM_1_0_17",		 "pos" : [{"left" : "617px","top" : "332px"}]},
		{"name" : "GGZM_1_0_15",		 "pos" : [{"left" : "488px","top" : "281px"}]},
		{"name" : "GGZM_1_0_18",		 "pos" : [{"left" : "562px","top" : "262px"}]},
		{"name" : "GGZM_1_0_13",		 "pos" : [{"left" : "513px","top" : "215px"}]},
		{"name" : "GGZM_1_0_16",		 "pos" : [{"left" : "500px","top" : "160px"}]},
		{"name" : "GGZM_1_0_22",		 "pos" : [{"left" : "751px","top" : "140px"}]},
		{"name" : "GGZM_1_0_21",		 "pos" : [{"left" : "783px","top" : "174px"}]},
		{"name" : "GGZM_1_0_25",		 "pos" : [{"left" : "811px","top" : "137px"}]},
		{"name" : "GGZM_1_0_28",		 "pos" : [{"left" : "966px","top" : "118px"}]},
		{"name" : "GGZM_1_0_34",		 "pos" : [{"left" : "930px","top" : "143px"}]},
		{"name" : "GGZM_1_0_36",		 "pos" : [{"left" : "948px","top" : "249px"}]},
		{"name" : "GGZM_1_0_31",		 "pos" : [{"left" : "1119px","top" : "221px"}]},
		{"name" : "GGZM_1_0_30",		 "pos" : [{"left" : "1021px","top" : "319px"}]},
		{"name" : "GGZM_1_0_23",		 "pos" : [{"left" : "837px","top" : "371px"}]},
		{"name" : "GGZM_1_0_27",		 "pos" : [{"left" : "693px","top" : "283px"}]},
		{"name" : "GGZM_1_0_28",		 "pos" : [{"left" : "810px","top" : "265px"}]}
	],
	"B2" : [
		{"name" : "GGZM_1_1_9",		 "pos" : [{"left" : "309px","top" : "200px"}]},
		{"name" : "GGZM_1_1_1",		 "pos" : [{"left" : "380px","top" : "189px"}], "css" : "vertical"},
		{"name" : "GGZM_1_2_1",		 "pos" : [{"left" : "285px","top" : "231px"}]},
		{"name" : "GGZM_1_1_16",		 "pos" : [{"left" : "404px","top" : "169px"}]},
		{"name" : "GGZM_1_1_17",		 "pos" : [{"left" : "505px","top" : "160px"}]},
		{"name" : "GGZM_1_1_13",		 "pos" : [{"left" : "453px","top" : "187px"}]},
		{"name" : "GGZM_1_1_18",		 "pos" : [{"left" : "604px","top" : "163px"}], "css" : "vertical"},
		{"name" : "GGZM_1_2_4",		 "pos" : [{"left" : "484px","top" : "208px"}]},
		{"name" : "GGZM_1_1_15",		 "pos" : [{"left" : "413px","top" : "239px"}]},
		{"name" : "GGZM_1_1_11",		 "pos" : [{"left" : "538px","top" : "231px"}]},
		{"name" : "GGZM_1_1_34",		 "pos" : [{"left" : "665px","top" : "144px"}]},
		{"name" : "GGZM_1_1_35",		 "pos" : [{"left" : "759px","top" : "136px"}]},
		{"name" : "GGZM_1_1_33",		 "pos" : [{"left" : "666px","top" : "166px"}]},
		{"name" : "GGZM_1_1_31",		 "pos" : [{"left" : "760px","top" : "157px"}]},
		{"name" : "GGZM_1_1_52",		 "pos" : [{"left" : "893px","top" : "136px"}]},
		{"name" : "GGZM_1_1_57",		 "pos" : [{"left" : "955px","top" : "110px"}]},
		{"name" : "GGZM_1_1_54",		 "pos" : [{"left" : "1033px","top" : "124px"}]},
		{"name" : "GGZM_1_2_5",		 "pos" : [{"left" : "721px","top" : "186px"}]},
		{"name" : "GGZM_1_2_6",		 "pos" : [{"left" : "678px","top" : "208px"}]},
		{"name" : "GGZM_1_2_7",		 "pos" : [{"left" : "836px","top" : "174px"}]},
		{"name" : "GGZM_1_1_59",		 "pos" : [{"left" : "877px","top" : "156px"}]},
		{"name" : "GGZM_1_2_8",		 "pos" : [{"left" : "813px","top" : "191px"}]},
		{"name" : "GGZM_1_1_53",		 "pos" : [{"left" : "878px","top" : "197px"}]},
		{"name" : "GGZM_1_1_58",		 "pos" : [{"left" : "964px","top" : "129px"}], "css" : "vertical"},
		{"name" : "GGZM_1_2_9",		 "pos" : [{"left" : "1039px","top" : "146px"}]},
		{"name" : "GGZM_1_2_10",		 "pos" : [{"left" : "1028px","top" : "174px"}]},
		{"name" : "GGZM_1_1_2",		 "pos" : [{"left" : "377px","top" : "295px"}], "css" : "vertical"},
		{"name" : "GGZM_1_1_6",		 "pos" : [{"left" : "307px","top" : "337px"}]},
		{"name" : "GGZM_1_2_18",		 "pos" : [{"left" : "251px","top" : "360px"}]},
		{"name" : "GGZM_1_2_17",		 "pos" : [{"left" : "247px","top" : "383px"}]},
		{"name" : "GGZM_1_1_3",		 "pos" : [{"left" : "316px","top" : "410px"}]},
		{"name" : "GGZM_1_1_7",		 "pos" : [{"left" : "393px","top" : "379px"}], "css" : "vertical"},
		{"name" : "GGZM_1_1_8",		 "pos" : [{"left" : "374px","top" : "429px"}], "css" : "vertical"},
		{"name" : "GGZM_1_1_4",		 "pos" : [{"left" : "388px","top" : "493px"}], "css" : "vertical"},
		{"name" : "GGZM_1_1_72",		 "pos" : [{"left" : "443px","top" : "529px"}]},
		{"name" : "GGZM_1_1_14",		 "pos" : [{"left" : "539px","top" : "254px"}]},
		{"name" : "GGZM_1_1_12",		 "pos" : [{"left" : "524px","top" : "276px"}]},
		{"name" : "GGZM_1_2_16",		 "pos" : [{"left" : "537px","top" : "300px"}]},
		{"name" : "GGZM_1_2_15",		 "pos" : [{"left" : "521px","top" : "323px"}]},
		{"name" : "GGZM_1_1_25",		 "pos" : [{"left" : "492px","top" : "299px"}], "css" : "vertical"},
		{"name" : "GGZM_1_1_22",		 "pos" : [{"left" : "466px","top" : "363px"}]},
		{"name" : "GGZM_1_1_21",		 "pos" : [{"left" : "554px","top" : "358px"}]},
		{"name" : "GGZM_1_1_27",		 "pos" : [{"left" : "555px","top" : "381px"}]},
		{"name" : "GGZM_1_1_26",		 "pos" : [{"left" : "466px","top" : "386px"}]},
		{"name" : "GGZM_1_1_28",		 "pos" : [{"left" : "509px","top" : "404px"}]},
		{"name" : "GGZM_1_1_23",		 "pos" : [{"left" : "508px","top" : "434px"}]},
		{"name" : "GGZM_1_2_19",		 "pos" : [{"left" : "542px","top" : "494px"}]},
		{"name" : "GGZM_1_1_20",		 "pos" : [{"left" : "633px","top" : "304px"}]},
		{"name" : "GGZM_1_1_73",		 "pos" : [{"left" : "630px","top" : "459px"}]},
		{"name" : "GGZM_1_1_30",		 "pos" : [{"left" : "637px","top" : "443px"}]},
		{"name" : "GGZM_1_1_24",		 "pos" : [{"left" : "628px","top" : "423px"}]},
		{"name" : "GGZM_1_1_75",		 "pos" : [{"left" : "745px","top" : "443px"}]},
		{"name" : "GGZM_1_2_22",		 "pos" : [{"left" : "692px","top" : "474px"}]},
		{"name" : "GGZM_1_2_23",		 "pos" : [{"left" : "813px","top" : "463px"}]},
		{"name" : "GGZM_1_1_77",		 "pos" : [{"left" : "838px","top" : "437px"}]},
		{"name" : "GGZM_1_1_43",		 "pos" : [{"left" : "735px","top" : "353px"}]},
		{"name" : "GGZM_1_1_42",		 "pos" : [{"left" : "909px","top" : "418px"}], "css" : "vertical"},
		{"name" : "GGZM_1_1_79",		 "pos" : [{"left" : "982px","top" : "445px"}]},
		{"name" : "GGZM_1_2_25",		 "pos" : [{"left" : "1068px","top" : "436px"}]},
		{"name" : "GGZM_1_2_26",		 "pos" : [{"left" : "1075px","top" : "407px"}]},
		{"name" : "GGZM_1_1_68",		 "pos" : [{"left" : "1096px","top" : "378px"}]},
		{"name" : "GGZM_1_1_61",		 "pos" : [{"left" : "1079px","top" : "332px"}]},
		{"name" : "GGZM_1_1_62",		 "pos" : [{"left" : "1069px","top" : "307px"}]},
		{"name" : "GGZM_1_1_65",		 "pos" : [{"left" : "970px","top" : "315px"}]},
		{"name" : "GGZM_1_1_48",		 "pos" : [{"left" : "974px","top" : "338px"}]},
		{"name" : "GGZM_1_1_41",		 "pos" : [{"left" : "829px","top" : "298px"}], "css" : "vertical"},
		{"name" : "GGZM_1_1_40",		 "pos" : [{"left" : "731px","top" : "286px"}]},
		{"name" : "GGZM_1_1_36",		 "pos" : [{"left" : "753px","top" : "267px"}]},
		{"name" : "GGZM_1_1_32",		 "pos" : [{"left" : "723px","top" : "226px"}]},
		{"name" : "GGZM_1_1_46",		 "pos" : [{"left" : "843px","top" : "256px"}]},
		{"name" : "GGZM_1_1_56",		 "pos" : [{"left" : "922px","top" : "244px"}]},
		{"name" : "GGZM_1_1_51",		 "pos" : [{"left" : "911px","top" : "223px"}]},
		{"name" : "GGZM_1_2_11",		 "pos" : [{"left" : "862px","top" : "280px"}]},
		{"name" : "GGZM_1_2_12",		 "pos" : [{"left" : "838px","top" : "297px"}]},
		{"name" : "GGZM_1_2_13",		 "pos" : [{"left" : "753px","top" : "305px"}]},
		{"name" : "GGZM_1_2_14",		 "pos" : [{"left" : "724px","top" : "325px"}]},
		{"name" : "GGZM_1_1_55",		 "pos" : [{"left" : "1047px","top" : "267px"}]}
	]
}

var baseUrl = CONTEXT_PATH;

function createPosInfo(posArr){
    queryAllAsset(posArr);

}

// 创建dom
function createDom(id,name, left, top, css) {
	var $storePos = $("<div/>",{
        id:id,
		class : (css == "vertical" ? "vertical_light_state" : "light_state"),
		title : name
	}).hover(function(){
		$(this).css({"z-index": "200"});
	}, function(){
		$(this).css({"z-index": "100"});
	});
	
	$storePos.css({
		"left" : left,
		"top" : top
	});
	$storePos.appendTo($(".pmt"));
}

// 生成公共照明平面图及点位
function buildLspub() {
	$('.pmt_operate').hide(); // 隐藏步行街照明图例说明
	$('.block_pos').hide(); // 隐藏步行街照明区域
	$('.point').hide(); // 隐藏步行街照明
	$('.light_state').remove(); // 移除平面图中的div
	$('.vertical_light_state').remove(); // 移除平面图中的div
    var floor = $(".current > a").attr("location");
	$(".pmt").css("background", "url('../resources/css/images/ggzm_" + floor + ".jpg')"); // 修改画面的楼层背景图片
	createPosInfo(customConfig[floor]);
}

$(function(){
	
	$(".cataloge_class_three li").live("click", function(e){
        if($(".cur i").attr("id") == "LSPUB" && ($(".current").parent().parent().prev().attr("id") == 'UP' || $(".current").attr("id") == 'UP')){ // 地下停车场调用此方法
            $(".loop_info").show();
            $(".mode_operate").hide();
            var floor=$(".current a").attr("location");
            $(".floor_num").text(floor);
            $(".floor_num").next().text('');
            $(".block_num").text('');
            $(".kind_light").text('');
            $(".light_des").text('');

            if($("#btn_ascplanar").hasClass("cur")) { // 系统平面图
                buildLspub(); // 生成公共照明平面图及点位
            }
            if($("#btn_asc").hasClass("cur")){//系统设备列表
                selectLspubPage("First");
            }
        }
    });

    $(".vertical_light_state").live("click",function(){
        openSingle($(this).attr('title'),$(this).attr('id'));
    });

    $(".light_state").live("click",function(){
        openSingle($(this).attr('title'),$(this).attr('id'));
    });
});

function openSingle(title,id){
    clearBlockData();
    $divFather = $("<div/>");
    $label = $("<label/>", {
        text : title
    });
    $switchBtn = $("<input/>",{
        type : "checkbox",
        class : "toggle_switch",
        "assetnum" :id
    });
    $switchBtn.bootstrapSwitch('setState', false);
    $label.appendTo($divFather);
    $switchBtn.appendTo($divFather);
    $divFather.appendTo($(".each_loop_state"));
    $switchBtn.bootstrapSwitch();
    $switchBtn.bootstrapSwitch("setDisabled", true);
}

function queryAllAsset(posArr){
    var url = baseUrl+'/mctrl/getAssets';
    var systemId = $(".cur i").attr("id");
    var location = "";
    var subSystemCode = "";
    var current = $(".cataloge_class_three .current");
    if(current.length==0){
        subSystemCode = $(".cataloge_class_two .current").attr("id");
    }else{
        subSystemCode = current.parent().parent().prev().attr("id");
        location = $(".cataloge_class_two .current");
        if(location.length == 0){
            location = "F1";
        }else {
            location = $(".current > a").attr("location");
        }
        console.log("--location----"+location);
    }

    var params = {location:"AWD"+location,systemCode:systemId,subSystemCode:systemId};
    $.ajax({
        url:url,
        type:'POST',
        data:params,
        dataType:'json',
        async:true,
        success:function(data){
            //组织数据
            for(var i = 0; i < posArr.length; ++i){
                for(var k = 0; k < data.length; ++ k){
                    var ggzm=data[k].description.replace(/#/gm,'');
                    if(ggzm==posArr[i]["name"]){
                        createDom(data[k].assetnum,posArr[i]["name"], posArr[i]["pos"][0].left, posArr[i]["pos"][0].top, posArr[i]["css"]);
                    }
                }
            }
        },
        error : function(){
            console.log("error");
        }
    });
}









